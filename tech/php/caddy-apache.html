<h2 id="caddy-篇">caddy 篇</h2>

<h3 id="安装-caddy">安装 caddy</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl https://getcaddy.com | bash
</code></pre></div></div>

<h3 id="配置-caddyfile">配置 Caddyfile</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yun.lisz.me <span class="o">{</span>
    <span class="nb">gzip
    </span>proxy / http://127.0.0.1:10080
<span class="o">}</span>
</code></pre></div></div>

<h3 id="安装并配置-supervisor">安装并配置 supervisor</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 安装 superviosr</span>
<span class="nb">sudo </span>pip <span class="nb">install </span>supervisor
</code></pre></div></div>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># /etc/supervisord.conf`
</span>[<span class="n">program</span>:<span class="n">caddy</span>]
<span class="n">command</span>=<span class="n">caddy</span> -<span class="n">conf</span> /<span class="n">root</span>/<span class="n">Caddyfile</span>
<span class="n">user</span>=<span class="n">root</span>
<span class="n">autostart</span>=<span class="n">true</span>
<span class="n">autorestart</span>=<span class="n">true</span>
<span class="n">startsecs</span>=<span class="m">3</span>
<span class="n">stderr_logfile</span>=/<span class="n">tmp</span>/<span class="n">caddy_err</span>.<span class="n">log</span>
<span class="n">stdout_logfile</span>=/<span class="n">tmp</span>/<span class="n">caddy</span>.<span class="n">log</span>
[<span class="n">supervisord</span>]
</code></pre></div></div>

<h3 id="安装-apache">安装 apache</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> apache2 
<span class="nb">sudo </span>a2enmod rewrite <span class="nb">env </span>headers mime <span class="nb">dir </span>setenvif
</code></pre></div></div>

<h2 id="php-篇">php 篇</h2>

<h3 id="安装-php70">安装 php7.0</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>python-software-properties
<span class="nb">sudo </span>add-apt-repository ppa:ondrej/php
<span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> php7.0
<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> libapache2-mod-php7.0 php7.0-mysql php7.0-curl php7.0-json 
<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> php7.0-common php7.0-gd php7.0-zip php7.0-xml php7.0-mbstring
<span class="nb">sudo </span>systemctl restart apache2.service
</code></pre></div></div>

<h3 id="配置虚拟主机">配置虚拟主机</h3>

<pre><code class="language-apacheconf"># /etc/apache2/sites-available/yun.conf
&lt;VirtualHost *:10080&gt;
    DocumentRoot "/var/www/yun"
    ServerName yun.lisz.me
    &lt;Directory "/var/www/yun"&gt;
        Options Indexes FollowSymLinks Includes ExecCGI
        AllowOverride All
        Order allow,deny
        Allow from all
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</code></pre>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 使配置生效</span>
<span class="nb">sudo ln</span> <span class="nt">-s</span> /etc/apache2/sites-available/yun.conf /etc/apache2/sites-enabled/yun.conf
<span class="nb">sudo </span>systemctl restart apache2.service
</code></pre></div></div>

<h2 id="mysql-篇">Mysql 篇</h2>

<h3 id="安装-mysql">安装 mysql</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>mariadb-server mariadb-client <span class="nt">-y</span>
</code></pre></div></div>

<h3 id="配置-mysql">配置 mysql</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 设置开机启动</span>
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>mariadb.service
<span class="c"># 设置一些安全问题</span>
<span class="nb">sudo </span>mysql_secure_installation
<span class="c"># 然后按照下面的问题进行设置，目前是没有设置密码的，所以直接回车进入下一步：</span>
Enter current password <span class="k">for </span>root <span class="o">(</span>enter <span class="k">for </span>none<span class="o">)</span>:
<span class="c"># 回车设置新的数据库密码：</span>
Set root password? <span class="o">[</span>Y/n]
<span class="c"># 输入新的密码并确认：</span>
New password:
Re-enter new password:
Password updated successfully!
<span class="c"># 输入回车移除匿名用户：</span>
Remove anonymous <span class="nb">users</span>? <span class="o">[</span>Y/n]
<span class="c"># 输入回车禁止远程 root 用户登陆：（此处可以选择 n 允许 root 用户远程连接）</span>
Disallow root login remotely? <span class="o">[</span>Y/n]
<span class="c"># 输入回车移除测试数据库：</span>
Remove <span class="nb">test </span>database and access to it? <span class="o">[</span>Y/n]
<span class="c"># 输入回车进行重载：</span>
Reload privilege tables now? <span class="o">[</span>Y/n]
</code></pre></div></div>

<p>  以上就完成了数据库的安全设置。</p>
